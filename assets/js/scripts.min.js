!function(e,r){for(var n in r)e[n]=r[n]}(exports,function(e){var r={};function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)n.d(t,a,function(r){return e[r]}.bind(null,a));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=0)}([function(e,r,n){n(1),jQuery(function(e){var r=!0,n=!1,t=!1,a=e(".uniqueTransactionIdHiddenForm").val();function o(n){var s=e("#seedpayPhoneNumber").val();a||!n?jQuery.post(seedpay_params.ajax_url,{action:"checkTransactionStatus",transaction_id:a,phone:s},function(a){var s=function(n,t){e(".seedpay-messages").html(n),e(".seedpay-number-form-pending").hide(),e(".seedpay-number-form").fadeIn(),r=!1;var a={error:n};return t&&t(a),a};if("string"==typeof a)return s(a,n);let u=a.response.tryParseJson();if(a.error||u.errors||!(u||u[0]||u[0].status))return s(u.errors[0]||a.error||"Error while checking your transaction's status",n);var i=u[0].status;"acceptedAndPaid"==i?(e(".seedpay-number-form").hide(),e(".seedpay-number-form-pending").hide(),e(".seedpay-number-form-success").fadeIn(),e(".woocommerce-checkout").submit(),r=!1):"rejected"==i||"errored"==i?(e(".seedpay-number-form-pending").hide(),e(".seedpay-number-form").fadeIn(),r=!1):t||(t=!0,function e(){r?setTimeout(function(){o(),e()},5e3):t=!1}()),n&&n()}):n()}function s(){e(".seedpay-number-form-pending").hide(),e(".seedpay-number-form").fadeIn(),e(".seedpay-messages").empty("");var r=e("#seedpayPhoneNumber").val();return jQuery.post(seedpay_params.ajax_url,{action:"requestPayment",phone:r},function(r){var n=(r||{response:""}).response.tryParseJson();r&&n&&n.message&&(e(".seedpay-messages").html(n.message),n.message.toLowerCase().indexOf("inv")>=0)?u():r.error?e(".seedpay-messages").html(r.error):(a=r.request.uniqueTransactionId,e(".uniqueTransactionIdHiddenForm").val(a),e(".seedpay-messages").html(n.message),e(".seedpay-number-form").fadeOut(),e(".seedpay-number-form-pending").fadeIn(),o())}),!1}function u(){var t=e("#seedpayPhoneNumber").val();jQuery.post(seedpay_params.ajax_url,{action:"checkUserStatus",phone:t},function(t){if(1==e.parseJSON(t).response.isRegistered)return e(".seedpay_payment_registered").val(1),void s();e(".seedpay_payment_registered").val(0),e(".seedpay-messages").html("Please check your text messages for an invite."),r=!0,n||(n=!0,function e(){r?setTimeout(function(){u(),e()},5e3):n=!1}())})}e("form.woocommerce-checkout").on("checkout_place_order",function(){if(e("#payment_method_seedpay").is(":checked"))return r=!0,e("#seedpayPhoneNumber").val(e("#seedpayPhoneNumber").val().replace(/\D/g,"")),s(),!1}),e(document).on("click",".seedpay-cancel-payment-submit",function(){return e(".seedpay-number-form-pending").hide(),e(".seedpay-number-form").fadeIn(),e(".seedpay-messages").empty(""),r=!1,!1}),1==e(".seedpay_recheck_payment").val()&&o()})},function(e,r){String.prototype.tryParseJson=function(){try{return JSON.parse(this)}catch(e){return!1}}}]));